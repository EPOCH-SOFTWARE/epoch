#!/bin/sh
# Get list of staged JS/TS files
FILES=$(git diff --cached --name-only --diff-filter=ACMR | grep -E '\.(js|jsx|ts|tsx)$')

if [ -n "$FILES" ]; then
    echo "🔍 Running ESLint on staged files..."
    npm run lint
    if [ $? -ne 0 ]; then
        echo "❌ ESLint failed. Please fix the errors before committing."
        exit 1
    fi
    
    echo "✅ ESLint passed!"
fi

# Run type checking
echo "🔍 Running TypeScript type checking..."
npm run type-check
if [ $? -ne 0 ]; then
    echo "❌ TypeScript type checking failed. Please fix the errors before committing."
    exit 1
fi

echo "✅ TypeScript type checking passed!"
echo "🎉 Pre-commit checks passed! Proceeding with commit..."
